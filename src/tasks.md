# Առաջադրանքների ասինխրոն ծրագրավորման մոդել (Task asynchronous programming model)

## Բովանդակություն

- [Առաջադրանքների ասինխրոն ծրագրավորման մոդել (Task asynchronous programming model)](#առաջադրանքների-ասինխրոն-ծրագրավորման-մոդել-task-asynchronous-programming-model)
  - [Բովանդակություն](#բովանդակություն)
  - [Ներածություն](#ներածություն)
  - [Արձագանքողականության (responsiveness) բարելավում ասինխրոնության միջոցով](#արձագանքողականության-responsiveness-բարելավում-ասինխրոնության-միջոցով)
  - [Ասինխրոն մեթոդներ](#ասինխրոն-մեթոդներ)

## Ներածություն

Ծրագրի ընդհանուր արձագանքողականության, արտադրողականության բարելավման համար կիրառվում է ասինխրոն ծրագրավորում: C#-ն աջակցում է պարզեցված մոտեցում ասինխրոն ծրագրեր գրելու համար:

## Արձագանքողականության (responsiveness) բարելավում ասինխրոնության միջոցով

[Async improves responsiveness](https://learn.microsoft.com/en-us/dotnet/csharp/asynchronous-programming/task-asynchronous-programming-model#BKMK_WhentoUseAsynchrony)

Ասինխրոնությունը կարևոր է այնպիսի գործողությունների համար, որոնք կարող են ժամանակավոր ընդհատել ծրագրի աշխատանքը, օրինակ՝ վեբ ռեսուրսների հասանելիությունը (ենթադրենք մեր ծրագիրը պետք է միանա և տվյալներ ստանալ այլ վեբ սերվիսից)։ Վեբ ռեսուրսին հաստանելիությունը երբեմն դանդաղ է իսկ որոշ դեպքերում պատասխանը կարող է ուշանալ տվյալ համակարգի ծանրաբեռնվածության պատճառով։ Սինխրոն գործընթացում տվյալ գործունեությունը արգելափակվում է, ամբողջ ծրագիրը աշխատանքը, քանի որ այն պետք է սպասի հարցման ավարտին։ Ասինխրոն գործընթացում ծրագիրը կարող է շարունակել այլ աշխատանք կատարել, որը կախված չէ հարցվող վեբ ռեսուրսի հետ, մինչև խոչընդոտող հանդիսացող առաջադրանքի ավարտը։

Ասինխրոն ծրագրավորման միջոցով հնարավոր է բարելավել ծրագրի արձագանքողականությունը հետևյալ ոլորտներում՝

- Հասանելիություն web րեսուրսներին
- աշխատանք ֆայլերի հետ
- աշխատանք նկարների հետ
- Աշխատանք տվյալների բազայի հետ
- WCF ծրագրավորում

## Ասինխրոն մեթոդներ

[Async methods are easy to write](https://learn.microsoft.com/en-us/dotnet/csharp/asynchronous-programming/task-asynchronous-programming-model#BKMK_HowtoWriteanAsyncMethod)

C#-ում async և await բանալի բառերը async ծրագրավորման սիրտն են։ Այս երկու բանալի բառերի միջոցով հնարավոր է օգտագործել .NET Framework-ի, .NET Core-ի կամ Windows Runtime-ի ռեսուրսները ասինխրոն մեթոդ ստեղծելու համար գրեթե նույնքան հեշտությամբ, որքան սինխրոն մեթոդ եք ստեղծում։

Async բանալի բառն օգտագործելով սահմանվող ասինխրոն մեթոդները կոչվում են async մեթոդներ։

```c#
public async Task<int> GetUrlContentLengthAsync()
{
    using var client = new HttpClient();

    Task<string> getStringTask =
        client.GetStringAsync("https://learn.microsoft.com/dotnet"); 

    // Այս տողը կկատարվի մինչև նախորդ տողով սահմանված հարցման առաջադրանքի պատասխանի ստացումը
    DoIndependentWork(); 

    // կատարումը կանգ կառնի այստեղ մինչև getStringTask-ի ավարտը, կառավարումը փոխանցելով տվյալ մեթոդը կանչած ծրագրին
    string contents = await getStringTask; 

    return contents.Length;
}

void DoIndependentWork()
{
    Console.WriteLine("Working...");
}

```

Մեթոդի ստորագրությունը ներառում է `async` մոդիֆիկատորը։ Վերադարձվող տեսակը `Task<int>` է։ Մեթոդի անունն ըստ կոնվենցիայի ավարտվում է Async-ով։ Մեթոդի մարմնում GetStringAsync-ը վերադարձնում է Task<string>։ Դա նշանակում է, որ սպասելով առաջադրանքին, կստանաք տող (contents)։ Առաջադրանքին սպասելուց առաջ կարող եք կատարել աշխատանք, որը չի կախված GetStringAsync-ի տողից։

Ուշադրություն դարձրեք սպասման օպերատորին է (await)։ Այն կասեցնում է GetUrlContentLengthAsync-ը։
GetUrlContentLengthAsync-ը չի կարող շարունակվել մինչև getStringTask-ի ավարտը։ Մինչդեռ, կառավարումը վերադառնում է GetUrlContentLengthAsync-ի կանչողին։ Կառավարումը վերսկսվում է այստեղ, երբ getStringTask-ն ավարտվում է։ Այնուհետև սպասման օպերատորը ստանում է տողի արդյունքը getStringTask-ից։

Որպես մեթոդի վերադարձվող տիպ սահմանված է ամբողջ թիվ։ GetUrlContentLengthAsync-ին սպասող բոլոր մեթոդները կստանան ստացված տողի երկարության արժեքը։

Եթե GetUrlContentLengthAsync-ը որևէ աշխատանք չունի կատարելու GetStringAsync-ը կանչելու և դրա ավարտին սպասելու միջև ընկած ժամանակահատվածում, հնարավոր է պարզեցնել կոդը՝ կանչելով և սպասելով հետևյալ մեկ հրամանում։

```c#
string contents = await client.GetStringAsync("https://learn.microsoft.com/dotnet");
```
